<!DOCTYPE html>
<html>
<!-- control+alt+i opens dope editor in real time -->
<head>
     <title>weSurviv3D</title>
     <script src ="/js/aframe-v0.8.2.min.js"></script>
     <script src="js/component.js"></script>   
     <script src="js/genTerra.js"></script>  
     <script src="js/trees.js"></script>
     <script src="js/runtime.js"></script>
     <script src="js/remove-component.js"></script>
     <script src="js/collide-listener.js"></script>
     <script src="js/aframe-teleport-controls.js"></script>
     <script src="js/aframe-physics-system.js"></script>
     <script src="js/grab-listener.js"></script>
     <script src="js/mesh-smooth.js"></script>
     <script src="js/Water.js"></script>
     <!-- <script src="js/aframe-teleport-controls.min.js"></script> -->
     <script src="/socket.io/socket.io.js"></script>
     <script>
        let socket = io();

        //default connect event
        socket.on('connect', function() {
            console.log("connected!");
        });
        
        //spawining an object
        socket.on('Spawn_Object', function(data) {
            //make the object visible
            //let scene = document.querySelector('a-scene');
            let hand = document.querySelector('#hand');
            let rHand =  document.querySelector('#right-hand');
            let head =  document.querySelector('#head');

            let entity = document.createElement('a-entity');
            //entity.setAttribute('position', '10 10 10');
                //console.log("axe position at time of spawn: ", entity.getAttribute('position'));

            // let x = (rHand.getAttribute('position').x) + (head.getAttribute('position').x);
            // let y = (rHand.getAttribute('position').y) + (head.getAttribute('position').y);
            // let z = (rHand.getAttribute('position').z) + (head.getAttribute('position').z);
         
            //entity.setAttribute('position', x + ' ' + y + ' ' + z ) ;
            entity.setAttribute('position',rHand.getAttribute('position'));
            //entity.setAttribute('position', '0 0 0');
            entity.setAttribute('obj-model', 'obj: #Axe_1-obj');
            entity.setAttribute('material', 'mtl: #Axe_1-mtl');
            entity.setAttribute('scale', '0.05, 0.05, 0.05,');
            entity.setAttribute('rotation','0 0 0');
            entity.setAttribute('shadow', 'cast:true');
            entity.setAttribute('shadow', 'receive:true');
            // console.log("axe position at time of spawn: ", entity.getAttribute('position'));

            //entity.setAttribute('static-body', 'shape: box;');
            //entity.setAttribute('constraint','target: #hand; type: hinge; axis: 1 1 1; distance: 0; collideConnected: false');
            //entity.setAttribute('','false');
            //entity.setAttribute()
            entity.setAttribute('id','axe');
            //entity.setAttribute('visible', 'false');
            
            scene.appendChild(entity);
     
            //entity.setAttribute('scale', '0.05, 0.05, 0.05,');
            // console.log("axe position at time of spawn: ", entity.getAttribute('position'));
            rHand.appendChild(entity);            
            //entity.setAttribute('scale', '0.05, 0.05, 0.05,');
            // let axe = document.querySelector('#axe');
            //    console.log("Hand position at time of spawn: ", rHand.getAttribute('position'));
            //    console.log("axe position at time of spawn: ", entity.getAttribute('position'));
            // hand.setAttribute('constraint', 'target: none');
            // hand.setAttribute('visible', 'true');

            //create rgb color string for css
            let confirmationStr = 'boolean: ' + data.b + '.';
            console.log("boolean received: " + confirmationStr);
        });
     </script>
    

</head>
<body>
    <!-- stats -->
    <a-scene shadow="type: pcfbasic"  physics="driver: local; contactEquationStiffness: 1000; gravity: 0; friction: 100; debug: true;">

        <a-assets>

            <img id="skymap" src="/assets/textures/SynthSet.png"> 
            <img id="tree_2-mat" src="/assets/textures/IceCreme_tree.png">  
            <img id="popcornGreen" src="/assets/textures/Popcorn_green.png"> 

            <a-asset-item id="leftController" src="/assets/models/oculus-touch-controller-left.obj"></a-asset-item>
            <a-asset-item id="rightController" src="/assets/models/oculus-touch-controller-right.obj"></a-asset-item>
            <a-asset-item id="rightController-mat" src="/assets/textures/oculus-touch-controller-right.mtl"></a-asset-item>
            <a-asset-item id="leftController-mat" src="/assets/textures/oculus-touch-controller-left.mtl"></a-asset-item>
            
            <a-asset-item id="tree_1-obj" src="/assets/models/poptree.obj"></a-asset-item>
            <a-asset-item id="water-obj" src="/assets/models/plue.obj"></a-asset-item>
            <a-asset-item id="tree_1-mat" src="/assets/textures/tree_1_1.mtl"></a-asset-item>
            <a-asset-item id="tree_2-obj" src="/assets/models/IceCreme_tree.obj"></a-asset-item>
            <a-asset-item id="tree_3-obj" src="/assets/models/tree_2_2.obj"></a-asset-item>
            <a-asset-item id="tree_3-mat" src="/assets/textures/tree_2_2.mtl"></a-asset-item>
            <a-asset-item id="rock_01-mat" src="/assets/textures/rock_01.mtl"></a-asset-item>
            <a-asset-item id="rock_01-obj" src="/assets/models/rock_01.obj"></a-asset-item>

            <a-asset-item id="rock1-mat" src="/assets/textures/rock_01.mtl"></a-asset-item>
            <a-asset-item id="rock1-obj" src="/assets/models/rock1.obj"></a-asset-item>
            <a-asset-item id="rock2-mat" src="/assets/textures/rock_01.mtl"></a-asset-item>
            <a-asset-item id="rock2-obj" src="/assets/models/rock2.obj"></a-asset-item>
            <a-asset-item id="rock3-mat" src="/assets/textures/rock_01.mtl"></a-asset-item>
            <a-asset-item id="rock3-obj" src="/assets/models/rock3.obj"></a-asset-item>
            <a-asset-item id="rock4-mat" src="/assets/textures/rock_01.mtl"></a-asset-item>
            <a-asset-item id="rock4-obj" src="/assets/models/rock4.obj"></a-asset-item>
            <a-asset-item id="rock5-mat" src="/assets/textures/rock_01.mtl"></a-asset-item>
            <a-asset-item id="rock5-obj" src="/assets/models/rock5.obj"></a-asset-item>

            <a-asset-item id="bush-obj" src=/assets/models/Bush_1.obj></a-asset-item>
            <a-asset-item id="branch-obj" src=/assets/models/branch_1.obj></a-asset-item>

            <!-- adding our own models -->
            <a-asset-item id="Axe_1-obj" src="/assets/models/Axe_1.obj"></a-asset-item>
            <a-asset-item id="Axe_1-mtl" src="/assets/textures/Axe_1.mtl"></a-asset-item>

        </a-assets>

        <a-entity id="terrainGenerationObj" mesh-smooth genterra-component genwater-component position="0 0 0"></a-entity>
        <a-entity id="sky"
                geometry="primitive:sphere; radius:500"
                material="shader:flat; src:#skymap; side:back">
        </a-entity>
        
        <!-- Lights< -->
        <a-entity id="LightSUN" light="type:directional; 
        castShadow:true;
        color:#e5971b; 
        intensity:1.2; 
        shadowCameraLeft: -250;
        shadowCameraBottom: -250;
        shadowCameraRight: 250;
        shadowCameraTop: 250;
        shadowMapHeight: 512;
        shadowMapWidth: 512;" 
        scale="10 10 10" position="40 40 20"></a-entity>
        <!-- shadowCameraVisible: true; -->

        <a-entity id="LightBounce1 Side" light="type:directional; color:#e0d498; intensity:0.1;"
        scale="10 10 10" position="-40 0 -20" rotation="180 0 0"></a-entity>

        <a-entity id="LightBounce1 Side2" light="type:directional; color:#e0d498; intensity:0.1;"
        scale="10 10 10" position="40 0 20" rotation="180 0 0"></a-entity>

        <a-entity id="LightBounce2 Bottom" light="type:directional; color:#e0d498; intensity:0.1;"
        scale="10 10 10" position="0 -0.025 0" rotation="90 0 0"></a-entity>

        <a-entity light="type: ambient;  color:#e0d498;  intensity:0.3;"></a-entity>
        <!-- Lights> -->

        <a-entity id="cameraRig" position="0 0 0">
            <!-- camera -->
            <a-entity id="head" camera wasd-controls look-controls></a-entity>
            <!-- hand controls -->
            <!-- <a-entity id="left-hand" static-body="shape: box;" grab-listener constraint="type: lock" oculus-touch-controls="hand: left"></a-entity> -->
            <a-entity id="right-hand" static-body="shape: box;" constraint="collideConnected: false" grab-listener oculus-touch-controls="hand: right"></a-entity>
            <a-box 
            scale="0.2 0.2 0.2"
            
            id="hand"
            dynamic-body="shape: box;"
            constraint="target: #right-hand; type: pointToPoint; targetPivot: 0 0 0; axis: 0 0 0; collideConnected: false"
            visible="false"
            
                    ></a-box>
          </a-entity>

        <!-- <a-entity id="axe" position="0,0,0" scale="0.2,0.2,0.2" geometry="#Axe_1-obj" material="#Axe_1-mtl" dynamic-body="shape: box;"
        constraint="target: #right-hand; type: pointToPoint; targetPivot: 0 0 0; axis: 0 0 0;"
        ></a-entity> -->

    </a-scene>
 
</body>

</html>
